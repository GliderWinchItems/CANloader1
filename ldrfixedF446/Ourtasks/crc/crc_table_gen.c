/**************************************************************************
crc_table_gen.c - generate table for crc-32
***************************************************************************/
/*
10/03/2014
http://rosettacode.org/wiki/CRC-32

gcc crc_table_gen.c -o crc_table_gen -lz && ./crc_table_gen
*/

#include <inttypes.h>
#include <stdio.h>
#include <string.h>
#include <zlib.h>
 
const uint32_t crctable[256] = { \
	0x00000000,	/*   0 */
	0x77073096,	/*   1 */
	0xEE0E612C,	/*   2 */
	0x990951BA,	/*   3 */
	0x076DC419,	/*   4 */
	0x706AF48F,	/*   5 */
	0xE963A535,	/*   6 */
	0x9E6495A3,	/*   7 */
	0x0EDB8832,	/*   8 */
	0x79DCB8A4,	/*   9 */
	0xE0D5E91E,	/*  10 */
	0x97D2D988,	/*  11 */
	0x09B64C2B,	/*  12 */
	0x7EB17CBD,	/*  13 */
	0xE7B82D07,	/*  14 */
	0x90BF1D91,	/*  15 */
	0x1DB71064,	/*  16 */
	0x6AB020F2,	/*  17 */
	0xF3B97148,	/*  18 */
	0x84BE41DE,	/*  19 */
	0x1ADAD47D,	/*  20 */
	0x6DDDE4EB,	/*  21 */
	0xF4D4B551,	/*  22 */
	0x83D385C7,	/*  23 */
	0x136C9856,	/*  24 */
	0x646BA8C0,	/*  25 */
	0xFD62F97A,	/*  26 */
	0x8A65C9EC,	/*  27 */
	0x14015C4F,	/*  28 */
	0x63066CD9,	/*  29 */
	0xFA0F3D63,	/*  30 */
	0x8D080DF5,	/*  31 */
	0x3B6E20C8,	/*  32 */
	0x4C69105E,	/*  33 */
	0xD56041E4,	/*  34 */
	0xA2677172,	/*  35 */
	0x3C03E4D1,	/*  36 */
	0x4B04D447,	/*  37 */
	0xD20D85FD,	/*  38 */
	0xA50AB56B,	/*  39 */
	0x35B5A8FA,	/*  40 */
	0x42B2986C,	/*  41 */
	0xDBBBC9D6,	/*  42 */
	0xACBCF940,	/*  43 */
	0x32D86CE3,	/*  44 */
	0x45DF5C75,	/*  45 */
	0xDCD60DCF,	/*  46 */
	0xABD13D59,	/*  47 */
	0x26D930AC,	/*  48 */
	0x51DE003A,	/*  49 */
	0xC8D75180,	/*  50 */
	0xBFD06116,	/*  51 */
	0x21B4F4B5,	/*  52 */
	0x56B3C423,	/*  53 */
	0xCFBA9599,	/*  54 */
	0xB8BDA50F,	/*  55 */
	0x2802B89E,	/*  56 */
	0x5F058808,	/*  57 */
	0xC60CD9B2,	/*  58 */
	0xB10BE924,	/*  59 */
	0x2F6F7C87,	/*  60 */
	0x58684C11,	/*  61 */
	0xC1611DAB,	/*  62 */
	0xB6662D3D,	/*  63 */
	0x76DC4190,	/*  64 */
	0x01DB7106,	/*  65 */
	0x98D220BC,	/*  66 */
	0xEFD5102A,	/*  67 */
	0x71B18589,	/*  68 */
	0x06B6B51F,	/*  69 */
	0x9FBFE4A5,	/*  70 */
	0xE8B8D433,	/*  71 */
	0x7807C9A2,	/*  72 */
	0x0F00F934,	/*  73 */
	0x9609A88E,	/*  74 */
	0xE10E9818,	/*  75 */
	0x7F6A0DBB,	/*  76 */
	0x086D3D2D,	/*  77 */
	0x91646C97,	/*  78 */
	0xE6635C01,	/*  79 */
	0x6B6B51F4,	/*  80 */
	0x1C6C6162,	/*  81 */
	0x856530D8,	/*  82 */
	0xF262004E,	/*  83 */
	0x6C0695ED,	/*  84 */
	0x1B01A57B,	/*  85 */
	0x8208F4C1,	/*  86 */
	0xF50FC457,	/*  87 */
	0x65B0D9C6,	/*  88 */
	0x12B7E950,	/*  89 */
	0x8BBEB8EA,	/*  90 */
	0xFCB9887C,	/*  91 */
	0x62DD1DDF,	/*  92 */
	0x15DA2D49,	/*  93 */
	0x8CD37CF3,	/*  94 */
	0xFBD44C65,	/*  95 */
	0x4DB26158,	/*  96 */
	0x3AB551CE,	/*  97 */
	0xA3BC0074,	/*  98 */
	0xD4BB30E2,	/*  99 */
	0x4ADFA541,	/* 100 */
	0x3DD895D7,	/* 101 */
	0xA4D1C46D,	/* 102 */
	0xD3D6F4FB,	/* 103 */
	0x4369E96A,	/* 104 */
	0x346ED9FC,	/* 105 */
	0xAD678846,	/* 106 */
	0xDA60B8D0,	/* 107 */
	0x44042D73,	/* 108 */
	0x33031DE5,	/* 109 */
	0xAA0A4C5F,	/* 110 */
	0xDD0D7CC9,	/* 111 */
	0x5005713C,	/* 112 */
	0x270241AA,	/* 113 */
	0xBE0B1010,	/* 114 */
	0xC90C2086,	/* 115 */
	0x5768B525,	/* 116 */
	0x206F85B3,	/* 117 */
	0xB966D409,	/* 118 */
	0xCE61E49F,	/* 119 */
	0x5EDEF90E,	/* 120 */
	0x29D9C998,	/* 121 */
	0xB0D09822,	/* 122 */
	0xC7D7A8B4,	/* 123 */
	0x59B33D17,	/* 124 */
	0x2EB40D81,	/* 125 */
	0xB7BD5C3B,	/* 126 */
	0xC0BA6CAD,	/* 127 */
	0xEDB88320,	/* 128 */
	0x9ABFB3B6,	/* 129 */
	0x03B6E20C,	/* 130 */
	0x74B1D29A,	/* 131 */
	0xEAD54739,	/* 132 */
	0x9DD277AF,	/* 133 */
	0x04DB2615,	/* 134 */
	0x73DC1683,	/* 135 */
	0xE3630B12,	/* 136 */
	0x94643B84,	/* 137 */
	0x0D6D6A3E,	/* 138 */
	0x7A6A5AA8,	/* 139 */
	0xE40ECF0B,	/* 140 */
	0x9309FF9D,	/* 141 */
	0x0A00AE27,	/* 142 */
	0x7D079EB1,	/* 143 */
	0xF00F9344,	/* 144 */
	0x8708A3D2,	/* 145 */
	0x1E01F268,	/* 146 */
	0x6906C2FE,	/* 147 */
	0xF762575D,	/* 148 */
	0x806567CB,	/* 149 */
	0x196C3671,	/* 150 */
	0x6E6B06E7,	/* 151 */
	0xFED41B76,	/* 152 */
	0x89D32BE0,	/* 153 */
	0x10DA7A5A,	/* 154 */
	0x67DD4ACC,	/* 155 */
	0xF9B9DF6F,	/* 156 */
	0x8EBEEFF9,	/* 157 */
	0x17B7BE43,	/* 158 */
	0x60B08ED5,	/* 159 */
	0xD6D6A3E8,	/* 160 */
	0xA1D1937E,	/* 161 */
	0x38D8C2C4,	/* 162 */
	0x4FDFF252,	/* 163 */
	0xD1BB67F1,	/* 164 */
	0xA6BC5767,	/* 165 */
	0x3FB506DD,	/* 166 */
	0x48B2364B,	/* 167 */
	0xD80D2BDA,	/* 168 */
	0xAF0A1B4C,	/* 169 */
	0x36034AF6,	/* 170 */
	0x41047A60,	/* 171 */
	0xDF60EFC3,	/* 172 */
	0xA867DF55,	/* 173 */
	0x316E8EEF,	/* 174 */
	0x4669BE79,	/* 175 */
	0xCB61B38C,	/* 176 */
	0xBC66831A,	/* 177 */
	0x256FD2A0,	/* 178 */
	0x5268E236,	/* 179 */
	0xCC0C7795,	/* 180 */
	0xBB0B4703,	/* 181 */
	0x220216B9,	/* 182 */
	0x5505262F,	/* 183 */
	0xC5BA3BBE,	/* 184 */
	0xB2BD0B28,	/* 185 */
	0x2BB45A92,	/* 186 */
	0x5CB36A04,	/* 187 */
	0xC2D7FFA7,	/* 188 */
	0xB5D0CF31,	/* 189 */
	0x2CD99E8B,	/* 190 */
	0x5BDEAE1D,	/* 191 */
	0x9B64C2B0,	/* 192 */
	0xEC63F226,	/* 193 */
	0x756AA39C,	/* 194 */
	0x026D930A,	/* 195 */
	0x9C0906A9,	/* 196 */
	0xEB0E363F,	/* 197 */
	0x72076785,	/* 198 */
	0x05005713,	/* 199 */
	0x95BF4A82,	/* 200 */
	0xE2B87A14,	/* 201 */
	0x7BB12BAE,	/* 202 */
	0x0CB61B38,	/* 203 */
	0x92D28E9B,	/* 204 */
	0xE5D5BE0D,	/* 205 */
	0x7CDCEFB7,	/* 206 */
	0x0BDBDF21,	/* 207 */
	0x86D3D2D4,	/* 208 */
	0xF1D4E242,	/* 209 */
	0x68DDB3F8,	/* 210 */
	0x1FDA836E,	/* 211 */
	0x81BE16CD,	/* 212 */
	0xF6B9265B,	/* 213 */
	0x6FB077E1,	/* 214 */
	0x18B74777,	/* 215 */
	0x88085AE6,	/* 216 */
	0xFF0F6A70,	/* 217 */
	0x66063BCA,	/* 218 */
	0x11010B5C,	/* 219 */
	0x8F659EFF,	/* 220 */
	0xF862AE69,	/* 221 */
	0x616BFFD3,	/* 222 */
	0x166CCF45,	/* 223 */
	0xA00AE278,	/* 224 */
	0xD70DD2EE,	/* 225 */
	0x4E048354,	/* 226 */
	0x3903B3C2,	/* 227 */
	0xA7672661,	/* 228 */
	0xD06016F7,	/* 229 */
	0x4969474D,	/* 230 */
	0x3E6E77DB,	/* 231 */
	0xAED16A4A,	/* 232 */
	0xD9D65ADC,	/* 233 */
	0x40DF0B66,	/* 234 */
	0x37D83BF0,	/* 235 */
	0xA9BCAE53,	/* 236 */
	0xDEBB9EC5,	/* 237 */
	0x47B2CF7F,	/* 238 */
	0x30B5FFE9,	/* 239 */
	0xBDBDF21C,	/* 240 */
	0xCABAC28A,	/* 241 */
	0x53B39330,	/* 242 */
	0x24B4A3A6,	/* 243 */
	0xBAD03605,	/* 244 */
	0xCDD70693,	/* 245 */
	0x54DE5729,	/* 246 */
	0x23D967BF,	/* 247 */
	0xB3667A2E,	/* 248 */
	0xC4614AB8,	/* 249 */
	0x5D681B02,	/* 250 */
	0x2A6F2B94,	/* 251 */
	0xB40BBE37,	/* 252 */
	0xC30C8EA1,	/* 253 */
	0x5A05DF1B,	/* 254 */
	0x2D02EF8D,	/* 255 */
};
uint32_t rc_crc32(uint32_t crc, const char *buf, size_t len)
{
	uint8_t octet;
	const char *p, *q;
 
//	crc = ~crc;
	crc = ~0;
	q = buf + len;
	for (p = buf; p < q; p++) {
		octet = *p;  /* Cast to unsigned octet. */
		crc = (crc >> 8) ^ crctable[(crc & 0xff) ^ octet];
	}
	return ~crc;
}
 
int
main()
{
	int i;
	const char *s = "The quick brown fox jumps over the lazy dog";

	/* CRC via above routine */
	printf("%" PRIX32 "\n", rc_crc32(0, s, strlen(s)));

//	for (i = 0; i < 256; i++) {
//		printf("\t0x%08X,\t/* %3d */\n",table[i],i);
//	}
	/* CRC via zlib */
	printf("%lX\n", crc32(0, (const void*)s, strlen(s)));
 
	return 0;
}
